

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>test &mdash; Flock simulation 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=f2a433a1"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Flock simulation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">scripts</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Flock simulation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Module code</a></li>
      <li class="breadcrumb-item active">test</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for test</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flock_class</span><span class="w"> </span><span class="kn">import</span> <span class="n">Flock</span>

<span class="n">random_seed</span> <span class="o">=</span> <span class="mi">1999</span>


<div class="viewcode-block" id="test_invalid_type_N_birds_in_constructor">
<a class="viewcode-back" href="../test.html#test.test_invalid_type_N_birds_in_constructor">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_invalid_type_N_birds_in_constructor</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the Flock class constructor raises an error when an invalid type in N_birds argument is provided.</span>

<span class="sd">    GIVEN: An invalid type for N_birds in the class constructor</span>

<span class="sd">    WHEN: The constructor is called to create a Flock object</span>

<span class="sd">    THEN: A TypeError is raised </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span>
                       <span class="n">match</span> <span class="o">=</span> <span class="s1">&#39;Number of birds must be an integer number&#39;</span><span class="p">,</span>
                <span class="p">):</span> 
                    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="s1">&#39;mille&#39;</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_invalid_value_N_birds_in_constructor">
<a class="viewcode-back" href="../test.html#test.test_invalid_value_N_birds_in_constructor">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_invalid_value_N_birds_in_constructor</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the Flock class constructor raises an error when a negative number of birds is provided.</span>

<span class="sd">    GIVEN: A negative number for N_birds in the class constructor</span>

<span class="sd">    WHEN: The constructor is called to create a Flock object</span>

<span class="sd">    THEN: A ValueError is raised </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span>
                       <span class="n">match</span> <span class="o">=</span> <span class="s1">&#39;Number of birds must be &gt; 0&#39;</span><span class="p">,</span>
                <span class="p">):</span> 
                    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_invalid_type_space_length_in_constructor">
<a class="viewcode-back" href="../test.html#test.test_invalid_type_space_length_in_constructor">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_invalid_type_space_length_in_constructor</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the Flock class constructor raises an error when an invalid type in space_length argument is provided.</span>

<span class="sd">    GIVEN: An invalid type for space_length in the class constructor</span>

<span class="sd">    WHEN: The constructor is called to create a Flock object</span>

<span class="sd">    THEN: A TypeError is raised </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span>
                       <span class="n">match</span> <span class="o">=</span> <span class="s1">&#39;Space length must be a floating number&#39;</span><span class="p">,</span>
                <span class="p">):</span> 
                    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="s1">&#39;mille&#39;</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_invalid_value_space_length_in_constructor">
<a class="viewcode-back" href="../test.html#test.test_invalid_value_space_length_in_constructor">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_invalid_value_space_length_in_constructor</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the Flock class constructor raises an error when a negative number of space length is provided.</span>

<span class="sd">    GIVEN: A negative number for space_length in the class constructor</span>

<span class="sd">    WHEN: The constructor is called to create a Flock object</span>

<span class="sd">    THEN: A ValueError is raised </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span>
                       <span class="n">match</span> <span class="o">=</span> <span class="s1">&#39;Space length must be &gt; 0&#39;</span><span class="p">,</span>
                <span class="p">):</span> 
                    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_N_birds_initialized_correctly">
<a class="viewcode-back" href="../test.html#test.test_N_birds_initialized_correctly">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_N_birds_initialized_correctly</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the Flock class constructor correctly inizialize N_birds attribute inside the object.</span>

<span class="sd">    GIVEN: An acceptable N_birds value in the class constructor</span>

<span class="sd">    WHEN: The constructor is called to create a Flock object</span>

<span class="sd">    THEN: object.N_birds is equal to the given value</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">234</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">flock</span><span class="o">.</span><span class="n">N_birds</span><span class="p">,</span> <span class="mi">234</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_space_length_initialized_correctly">
<a class="viewcode-back" href="../test.html#test.test_space_length_initialized_correctly">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_space_length_initialized_correctly</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the Flock class constructor correctly inizialize space_length attribute inside the object.</span>

<span class="sd">    GIVEN: An acceptable space_length value in the class constructor</span>

<span class="sd">    WHEN: The constructor is called to create a Flock object</span>

<span class="sd">    THEN: object.space_length is equal to the given value</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mf">111.1</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">flock</span><span class="o">.</span><span class="n">space_length</span><span class="p">,</span> <span class="mf">111.1</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_positions_shape_initialized_correctly">
<a class="viewcode-back" href="../test.html#test.test_positions_shape_initialized_correctly">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_positions_shape_initialized_correctly</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the positions attribute of the object has the correct shape after an object is created.</span>

<span class="sd">    GIVEN: A Flock object</span>

<span class="sd">    WHEN: I access to his attribute positions</span>

<span class="sd">    THEN: object.positions has the right shape</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">flock</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_positions_values_initialized_correctly">
<a class="viewcode-back" href="../test.html#test.test_positions_values_initialized_correctly">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_positions_values_initialized_correctly</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the positions attribute of the object has every value in the right range.</span>

<span class="sd">    GIVEN: A Flock object</span>

<span class="sd">    WHEN: I access to his attribute positions</span>

<span class="sd">    THEN: Every entry of object.positions array is within the right range</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">flock</span><span class="o">.</span><span class="n">positions</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">flock</span><span class="o">.</span><span class="n">positions</span> <span class="o">&lt;=</span> <span class="mi">100</span><span class="p">))</span></div>




<div class="viewcode-block" id="test_velocities_shape_initialized_correctly">
<a class="viewcode-back" href="../test.html#test.test_velocities_shape_initialized_correctly">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_velocities_shape_initialized_correctly</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the velocities attribute of the object has the correct shape after an object is created.</span>

<span class="sd">    GIVEN: A Flock object</span>

<span class="sd">    WHEN: I access to his attribute velocities</span>

<span class="sd">    THEN: object.velocities has the right shape</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">flock</span><span class="o">.</span><span class="n">velocities</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span></div>



<div class="viewcode-block" id="test_init_given_positions_type_error_bool">
<a class="viewcode-back" href="../test.html#test.test_init_given_positions_type_error_bool">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_init_given_positions_type_error_bool</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the init_given_positions method raises a TypeError when a np.array with boolean values is given as input.</span>

<span class="sd">    GIVEN: An invalid input type for input_given_positions method</span>

<span class="sd">    WHEN: I call input_given_positions method</span>

<span class="sd">    THEN: A TypeError is raised</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">wrong_array</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span>

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span>
                       <span class="n">match</span> <span class="o">=</span> <span class="s1">&#39;The input array must contain only numeric values&#39;</span><span class="p">,</span>
                <span class="p">):</span> 
                    <span class="n">flock</span><span class="o">.</span><span class="n">init_given_positions</span><span class="p">(</span><span class="n">wrong_array</span><span class="p">)</span></div>



<div class="viewcode-block" id="test_init_given_positions_type_error_list">
<a class="viewcode-back" href="../test.html#test.test_init_given_positions_type_error_list">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_init_given_positions_type_error_list</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the init_given_positions method raises a TypeError when a list is given as input.</span>

<span class="sd">    GIVEN: An invalid input type for input_given_positions method</span>

<span class="sd">    WHEN: I call input_given_positions method</span>

<span class="sd">    THEN: A TypeError is raised</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">wrong_list</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span><span class="o">*</span><span class="mi">200</span>

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span>
                       <span class="n">match</span> <span class="o">=</span> <span class="s1">&#39;The input array must be a np.ndarray&#39;</span><span class="p">,</span>
                <span class="p">):</span> 
                    <span class="n">flock</span><span class="o">.</span><span class="n">init_given_positions</span><span class="p">(</span><span class="n">wrong_list</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_init_given_positions_value_error">
<a class="viewcode-back" href="../test.html#test.test_init_given_positions_value_error">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_init_given_positions_value_error</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the init_given_positions method raises a ValueError when an array with invalid shape is given as input.</span>

<span class="sd">    GIVEN: An array with invalid shape for input_given_positions method</span>

<span class="sd">    WHEN: I call input_given_positions method</span>

<span class="sd">    THEN: A ValueError is raised</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">wrong_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">199</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span> 
                    <span class="n">flock</span><span class="o">.</span><span class="n">init_given_positions</span><span class="p">(</span><span class="n">wrong_array</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_init_given_positions_value_error_when_not_in_range">
<a class="viewcode-back" href="../test.html#test.test_init_given_positions_value_error_when_not_in_range">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_init_given_positions_value_error_when_not_in_range</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the init_given_positions method raises a ValueError when the input array has values out of the right range.</span>

<span class="sd">    GIVEN: An array with invalid values for input_given_positions method</span>

<span class="sd">    WHEN: I call input_given_positions method</span>

<span class="sd">    THEN: A ValueError is raised</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">wrong_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span> 
                    <span class="n">flock</span><span class="o">.</span><span class="n">init_given_positions</span><span class="p">(</span><span class="n">wrong_array</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_init_given_positions_typical_usage">
<a class="viewcode-back" href="../test.html#test.test_init_given_positions_typical_usage">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_init_given_positions_typical_usage</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the init_given_positions input array is equal to the object.positions attribute after calling the method</span>

<span class="sd">    GIVEN: A valid array for init_given_positions method</span>

<span class="sd">    WHEN: I check object.positions attribute</span>

<span class="sd">    THEN: The two arrays are equal</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">input_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">200</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">flock</span><span class="o">.</span><span class="n">init_given_positions</span><span class="p">(</span><span class="n">input_array</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">input_array</span><span class="p">,</span> <span class="n">flock</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_init_given_positions_type_error_string">
<a class="viewcode-back" href="../test.html#test.test_init_given_positions_type_error_string">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_init_given_positions_type_error_string</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the init_given_positions method raises a TypeError when a np.array full of strings is given as input.</span>

<span class="sd">    GIVEN: An invalid input type for input_given_positions method</span>

<span class="sd">    WHEN: I call input_given_positions method</span>

<span class="sd">    THEN: A TypeError is raised</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">wrong_array</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;se telefonando&#39;</span><span class="p">,</span> <span class="s1">&#39;io&#39;</span><span class="p">,</span> <span class="s1">&#39;potessi dirti addio&#39;</span><span class="p">])</span>

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span>
                       <span class="n">match</span> <span class="o">=</span> <span class="s1">&#39;The input array must contain only numeric values&#39;</span><span class="p">,</span>
                <span class="p">):</span> 
                    <span class="n">flock</span><span class="o">.</span><span class="n">init_given_velocities</span><span class="p">(</span><span class="n">wrong_array</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_init_given_velocities_type_error_list">
<a class="viewcode-back" href="../test.html#test.test_init_given_velocities_type_error_list">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_init_given_velocities_type_error_list</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the init_given_velocities method raises a TypeError when a list is given as input.</span>

<span class="sd">    GIVEN: An invalid input type for input_given_velocities method</span>

<span class="sd">    WHEN: I call input_given_velocities method</span>

<span class="sd">    THEN: A TypeError is raised</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">wrong_list</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span><span class="o">*</span><span class="mi">200</span>

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span>
                       <span class="n">match</span> <span class="o">=</span> <span class="s1">&#39;The input array must be a np.ndarray&#39;</span><span class="p">,</span>
                <span class="p">):</span> 
                    <span class="n">flock</span><span class="o">.</span><span class="n">init_given_velocities</span><span class="p">(</span><span class="n">wrong_list</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_init_given_velocities_value_error">
<a class="viewcode-back" href="../test.html#test.test_init_given_velocities_value_error">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_init_given_velocities_value_error</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the init_given_velocities method raises a ValueError when an array with invalid shape is given as input.</span>

<span class="sd">    GIVEN: An array with invalid shape for input_given_velocities method</span>

<span class="sd">    WHEN: I call input_given_velocities method</span>

<span class="sd">    THEN: A ValueError is raised</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">wrong_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">199</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span> 
                    <span class="n">flock</span><span class="o">.</span><span class="n">init_given_velocities</span><span class="p">(</span><span class="n">wrong_array</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_init_given_velocities_value_error_when_not_in_range">
<a class="viewcode-back" href="../test.html#test.test_init_given_velocities_value_error_when_not_in_range">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_init_given_velocities_value_error_when_not_in_range</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the init_given_velocities method raises a ValueError when the input array has values out of the right range.</span>

<span class="sd">    GIVEN: An array with invalid values for input_given_velocities method</span>

<span class="sd">    WHEN: I call input_given_velocities method</span>

<span class="sd">    THEN: A ValueError is raised</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">wrong_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n">flock</span><span class="o">.</span><span class="n">max_speed</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span> 
                    <span class="n">flock</span><span class="o">.</span><span class="n">init_given_velocities</span><span class="p">(</span><span class="n">wrong_array</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_init_given_velocities_typical_usage">
<a class="viewcode-back" href="../test.html#test.test_init_given_velocities_typical_usage">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_init_given_velocities_typical_usage</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the init_given_velocities input array is equal to the object.velocities attribute after calling the method.</span>

<span class="sd">    GIVEN: A valid array for init_given_velocities method</span>

<span class="sd">    WHEN: I check object.velocities attribute</span>

<span class="sd">    THEN: The two arrays are equal</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">input_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">200</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">flock</span><span class="o">.</span><span class="n">init_given_velocities</span><span class="p">(</span><span class="n">input_array</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">input_array</span><span class="p">,</span> <span class="n">flock</span><span class="o">.</span><span class="n">velocities</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_directions_between_birds_right_shape">
<a class="viewcode-back" href="../test.html#test.test_directions_between_birds_right_shape">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_directions_between_birds_right_shape</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _directions_between_birds method returns an array with the correct shape.</span>

<span class="sd">    GIVEN: A Flock object</span>

<span class="sd">    WHEN: I call _directions_between_birds method</span>

<span class="sd">    THEN: The resulting array has shape (N_birds, N_birds, 2)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">directions</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_directions_between_birds</span><span class="p">()</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">directions</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_directions_between_birds_single_bird">
<a class="viewcode-back" href="../test.html#test.test_directions_between_birds_single_bird">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_directions_between_birds_single_bird</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _directions_between_birds method computed with only one bird returns an array of zeros.</span>

<span class="sd">    GIVEN: A Flock object with a single bird</span>

<span class="sd">    WHEN: I call _directions_between_birds method</span>

<span class="sd">    THEN: The resulting array is an array of zeros</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">directions</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_directions_between_birds</span><span class="p">()</span>
    <span class="n">zero_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">directions</span><span class="p">,</span> <span class="n">zero_array</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_directions_between_birds_collapsed_positions">
<a class="viewcode-back" href="../test.html#test.test_directions_between_birds_collapsed_positions">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_directions_between_birds_collapsed_positions</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _directions_between_birds method computed when every bird is in the same position returns an array of zeros.</span>

<span class="sd">    GIVEN: A Flock object with every bird having the same position</span>

<span class="sd">    WHEN: I call _directions_between_birds method</span>

<span class="sd">    THEN: The resulting array is an array of zeros</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">zero_positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">200</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">flock</span><span class="o">.</span><span class="n">init_given_positions</span><span class="p">(</span><span class="n">zero_positions</span><span class="p">)</span>

    <span class="n">directions</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_directions_between_birds</span><span class="p">()</span>
    <span class="n">zero_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">directions</span><span class="p">,</span> <span class="n">zero_array</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_directions_between_birds_typical_usage">
<a class="viewcode-back" href="../test.html#test.test_directions_between_birds_typical_usage">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_directions_between_birds_typical_usage</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _directions_between_birds returns the correct array when called on two birds.</span>

<span class="sd">    GIVEN: A Flock object with two birds with known positions</span>

<span class="sd">    WHEN: I call _directions_between_birds method</span>

<span class="sd">    THEN: The resulting array is computed correctly</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">initial_positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
    <span class="n">flock</span><span class="o">.</span><span class="n">init_given_positions</span><span class="p">(</span><span class="n">initial_positions</span><span class="p">)</span>

    <span class="n">directions</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_directions_between_birds</span><span class="p">()</span>

    <span class="n">right_directions</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">positions</span> <span class="o">-</span> <span class="n">flock</span><span class="o">.</span><span class="n">positions</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">directions</span><span class="p">,</span> <span class="n">right_directions</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_distances_between_birds_right_shape">
<a class="viewcode-back" href="../test.html#test.test_distances_between_birds_right_shape">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_distances_between_birds_right_shape</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _distances_between_birds method returns an array with the correct shape.</span>

<span class="sd">    GIVEN: A Flock object</span>

<span class="sd">    WHEN: I call _distances_between_birds method</span>

<span class="sd">    THEN: The resulting array has shape (N_birds, N_birds)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">distances</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_distances_between_birds</span><span class="p">()</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">distances</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_distances_between_birds_single_bird">
<a class="viewcode-back" href="../test.html#test.test_distances_between_birds_single_bird">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_distances_between_birds_single_bird</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _distances_between_birds method computed with only one bird returns an array of np.inf.</span>

<span class="sd">    GIVEN: A Flock object with a single bird</span>

<span class="sd">    WHEN: I call _distances_between_birds method</span>

<span class="sd">    THEN: The resulting array is an array of np.inf</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">distances</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_distances_between_birds</span><span class="p">()</span>
    <span class="n">inf_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">distances</span><span class="p">,</span> <span class="n">inf_array</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_distances_between_birds_collapsed_positions">
<a class="viewcode-back" href="../test.html#test.test_distances_between_birds_collapsed_positions">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_distances_between_birds_collapsed_positions</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _distances_between_birds method computed when every bird is in the same position returns an array of np.inf.</span>

<span class="sd">    GIVEN: A Flock object with every bird having the same position</span>

<span class="sd">    WHEN: I call _distances_between_birds method</span>

<span class="sd">    THEN: The resulting array is an array of np.inf</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">zero_positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">200</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">flock</span><span class="o">.</span><span class="n">init_given_positions</span><span class="p">(</span><span class="n">zero_positions</span><span class="p">)</span>

    <span class="n">distances</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_distances_between_birds</span><span class="p">()</span>
    <span class="n">inf_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">distances</span><span class="p">,</span> <span class="n">inf_array</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_distances_between_birds_typical_usage">
<a class="viewcode-back" href="../test.html#test.test_distances_between_birds_typical_usage">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_distances_between_birds_typical_usage</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _distances_between_birds returns the correct array when called on two birds.</span>

<span class="sd">    GIVEN: A Flock object with two birds with known positions</span>

<span class="sd">    WHEN: I call _distances_between_birds method</span>

<span class="sd">    THEN: The resulting array is computed correctly</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">initial_positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
    <span class="n">flock</span><span class="o">.</span><span class="n">init_given_positions</span><span class="p">(</span><span class="n">initial_positions</span><span class="p">)</span>

    <span class="n">distances</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_distances_between_birds</span><span class="p">()</span>

    <span class="n">directions</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_directions_between_birds</span><span class="p">()</span>

    <span class="n">right_distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">directions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">right_distances</span><span class="p">[</span><span class="n">right_distances</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">distances</span><span class="p">,</span> <span class="n">right_distances</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_directions_unitary_vectors_correct_shape">
<a class="viewcode-back" href="../test.html#test.test_directions_unitary_vectors_correct_shape">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_directions_unitary_vectors_correct_shape</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _directions_unitary_vectors method returns an array with the correct shape.</span>

<span class="sd">    GIVEN: A Flock object</span>

<span class="sd">    WHEN: I call _directions_unitary_vectors method</span>

<span class="sd">    THEN: The resulting array has shape (N_birds, N_birds, 2)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">unit_distances</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_directions_unitary_vectors</span><span class="p">()</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">unit_distances</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span></div>





<div class="viewcode-block" id="test_directions_unitary_vectors_single_bird">
<a class="viewcode-back" href="../test.html#test.test_directions_unitary_vectors_single_bird">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_directions_unitary_vectors_single_bird</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _directions_unitary_vectors method computed with only one bird returns an array of zeros.</span>

<span class="sd">    GIVEN: A Flock object with a single bird</span>

<span class="sd">    WHEN: I call _directions_unitary_vectors method</span>

<span class="sd">    THEN: The resulting array is an array of zeros</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">unit_distances</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_directions_unitary_vectors</span><span class="p">()</span>
    <span class="n">zero_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">unit_distances</span><span class="p">,</span> <span class="n">zero_array</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_directions_unitary_vectors_collapsed_positions">
<a class="viewcode-back" href="../test.html#test.test_directions_unitary_vectors_collapsed_positions">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_directions_unitary_vectors_collapsed_positions</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _directions_unitary_vectors method computed when every bird is in the same position returns an array of zeros.</span>

<span class="sd">    GIVEN: A Flock object with every bird having the same position</span>

<span class="sd">    WHEN: I call _directions_unitary_vectors method</span>

<span class="sd">    THEN: The resulting array is an array of zeros</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">zero_positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">200</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">flock</span><span class="o">.</span><span class="n">init_given_positions</span><span class="p">(</span><span class="n">zero_positions</span><span class="p">)</span>

    <span class="n">unit_directions</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_directions_unitary_vectors</span><span class="p">()</span>
    <span class="n">zero_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">unit_directions</span><span class="p">,</span> <span class="n">zero_array</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_directions_unitary_vectors_typical_usage_off_diagonal">
<a class="viewcode-back" href="../test.html#test.test_directions_unitary_vectors_typical_usage_off_diagonal">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_directions_unitary_vectors_typical_usage_off_diagonal</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _directions_unitary_vectors returns an array which rows are normalized to one.</span>

<span class="sd">    GIVEN: A Flock object </span>

<span class="sd">    WHEN: I call _directions_unitary_vectors method</span>

<span class="sd">    THEN: The resulting array rows are normalized to one</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>

    <span class="n">unit_distances</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_directions_unitary_vectors</span><span class="p">()</span>

    <span class="n">diagonal_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
    <span class="n">normalized_rows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">unit_distances</span><span class="p">[</span><span class="o">~</span><span class="n">diagonal_mask</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">correct_normalization</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">200</span><span class="o">*</span><span class="mi">200</span><span class="o">-</span><span class="mi">200</span><span class="p">)</span>
    

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">normalized_rows</span><span class="p">,</span> <span class="n">correct_normalization</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_directions_unitary_vectors_typical_usage_on_diagonal">
<a class="viewcode-back" href="../test.html#test.test_directions_unitary_vectors_typical_usage_on_diagonal">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_directions_unitary_vectors_typical_usage_on_diagonal</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _directions_unitary_vectors returns a matrix which has 0 on the diagonal.</span>

<span class="sd">    GIVEN: A Flock object </span>

<span class="sd">    WHEN: I call _directions_unitary_vectors method</span>

<span class="sd">    THEN: The resulting matrix has zeros on the diagonal</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>

    <span class="n">unit_distances</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_directions_unitary_vectors</span><span class="p">()</span>

    <span class="n">diagonal_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
    <span class="n">normalized_rows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">unit_distances</span><span class="p">[</span><span class="n">diagonal_mask</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">correct_normalization</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
    

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">normalized_rows</span><span class="p">,</span> <span class="n">correct_normalization</span><span class="p">,</span> <span class="n">atol</span> <span class="o">=</span> <span class="mf">1e-3</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_directions_unitary_vectors_typical_usage">
<a class="viewcode-back" href="../test.html#test.test_directions_unitary_vectors_typical_usage">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_directions_unitary_vectors_typical_usage</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _directions_unitary_vectors returns the correct array when called on two birds.</span>

<span class="sd">    GIVEN: A Flock object with two birds with known positions</span>

<span class="sd">    WHEN: I call _directions_unitary_vectors method</span>

<span class="sd">    THEN: The resulting array is computed correctly</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">initial_positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
    <span class="n">flock</span><span class="o">.</span><span class="n">init_given_positions</span><span class="p">(</span><span class="n">initial_positions</span><span class="p">)</span>

    <span class="n">unit_directions</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_directions_unitary_vectors</span><span class="p">()</span>

    <span class="n">directions</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_directions_between_birds</span><span class="p">()</span>
    <span class="n">distances</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_distances_between_birds</span><span class="p">()</span>

    <span class="n">right_unit_directions</span> <span class="o">=</span> <span class="n">directions</span> <span class="o">/</span> <span class="n">distances</span><span class="p">[:,:,</span><span class="kc">None</span><span class="p">]</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">unit_directions</span><span class="p">,</span> <span class="n">right_unit_directions</span><span class="p">)</span></div>





<div class="viewcode-block" id="test_speed_limit_factors_correct_shape">
<a class="viewcode-back" href="../test.html#test.test_speed_limit_factors_correct_shape">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_speed_limit_factors_correct_shape</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _speed_limit_factors method returns an array with the correct shape.</span>

<span class="sd">    GIVEN: A Flock object</span>

<span class="sd">    WHEN: I call _speed_limit_factors method</span>

<span class="sd">    THEN: The resulting array has shape (N_birds)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>

    <span class="n">speed_limit_factors</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_speed_limit_factors</span><span class="p">()</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">speed_limit_factors</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">200</span><span class="p">,)</span></div>





<div class="viewcode-block" id="test_speed_limit_factors_zero_velocities">
<a class="viewcode-back" href="../test.html#test.test_speed_limit_factors_zero_velocities">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_speed_limit_factors_zero_velocities</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _speed_limit_factors method returns an array full one ones if the object.velocities are zeros.</span>

<span class="sd">    GIVEN: A Flock object with object.velocities being full of zeros</span>

<span class="sd">    WHEN: I call _speed_limit_factors method</span>

<span class="sd">    THEN: The resulting array is full of ones</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">zero_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">200</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">flock</span><span class="o">.</span><span class="n">init_given_velocities</span><span class="p">(</span><span class="n">zero_array</span><span class="p">)</span>

    <span class="n">speed_limit_factors</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_speed_limit_factors</span><span class="p">()</span>
    <span class="n">correct_speed_limits</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">200</span><span class="p">))</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">speed_limit_factors</span><span class="p">,</span> <span class="n">correct_speed_limits</span><span class="p">)</span></div>





<div class="viewcode-block" id="test_speed_limit_factors_typical_usage">
<a class="viewcode-back" href="../test.html#test.test_speed_limit_factors_typical_usage">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_speed_limit_factors_typical_usage</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _speed_limit_factors returns the correct array when called on two birds.</span>

<span class="sd">    GIVEN: A Flock object</span>

<span class="sd">    WHEN: I call _speed_limit_factors method</span>

<span class="sd">    THEN: The resulting array is computed correctly</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    
    <span class="n">speed_limit_factors</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_speed_limit_factors</span><span class="p">()</span>

    <span class="n">correct_speed_limit_factors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">flock</span><span class="o">.</span><span class="n">velocities</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">flock</span><span class="o">.</span><span class="n">max_speed</span>
    <span class="n">correct_speed_limit_factors</span><span class="p">[</span><span class="n">correct_speed_limit_factors</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">correct_speed_limit_factors</span><span class="p">,</span> <span class="n">speed_limit_factors</span><span class="p">)</span></div>



       
<div class="viewcode-block" id="test_visual_range_mask_typeerror">
<a class="viewcode-back" href="../test.html#test.test_visual_range_mask_typeerror">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_visual_range_mask_typeerror</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _visual_range_mask method raises a TypeError when a string is given as input.</span>

<span class="sd">    GIVEN: An invalid input type for _visual_range_mask method</span>

<span class="sd">    WHEN: I call _visual_range_mask method</span>

<span class="sd">    THEN: A TypeError is raised</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span>
                       <span class="n">match</span> <span class="o">=</span> <span class="s1">&#39;Visual range must be a floating number&#39;</span><span class="p">,</span>
                <span class="p">):</span> 
                    <span class="n">flock</span><span class="o">.</span><span class="n">_visual_range_mask</span><span class="p">(</span><span class="n">visual_range</span> <span class="o">=</span> <span class="s1">&#39;ventimilioni&#39;</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_visual_range_mask_valueerror">
<a class="viewcode-back" href="../test.html#test.test_visual_range_mask_valueerror">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_visual_range_mask_valueerror</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _visual_range_mask method raises a ValueError when a negative value is given as input.</span>

<span class="sd">    GIVEN: An invalid input value for _visual_range_mask method</span>

<span class="sd">    WHEN: I call _visual_range_mask method</span>

<span class="sd">    THEN: A ValueError is raised</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
                    <span class="n">flock</span><span class="o">.</span><span class="n">_visual_range_mask</span><span class="p">(</span><span class="n">visual_range</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">)</span></div>





<div class="viewcode-block" id="test_visual_range_mask_correct_shape">
<a class="viewcode-back" href="../test.html#test.test_visual_range_mask_correct_shape">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_visual_range_mask_correct_shape</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _visual_range_mask method returns a np.ndarray with the correct shape.</span>

<span class="sd">    GIVEN: A Flock object</span>

<span class="sd">    WHEN: I call _visual_range_mask method</span>

<span class="sd">    THEN: The resulting array has shape (N_birds, N_birds)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_visual_range_mask</span><span class="p">(</span><span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span></div>





<div class="viewcode-block" id="test_visual_range_mask_zero_visual_range">
<a class="viewcode-back" href="../test.html#test.test_visual_range_mask_zero_visual_range">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_visual_range_mask_zero_visual_range</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _visual_range_mask method returns a mask full of False when visual_range is 0.</span>

<span class="sd">    GIVEN: A Flock object</span>

<span class="sd">    WHEN: I call _visual_range_mask method with visual_range = 0</span>

<span class="sd">    THEN: The resulting mask is full of False</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_visual_range_mask</span><span class="p">(</span><span class="n">visual_range</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">zero_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">),</span> <span class="n">dtype</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">zero_mask</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_visual_range_mask_zero_tyipical_usage">
<a class="viewcode-back" href="../test.html#test.test_visual_range_mask_zero_tyipical_usage">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_visual_range_mask_zero_tyipical_usage</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _visual_range_mask method returns a mask with True off the diagonal when birds are near each other.</span>

<span class="sd">    GIVEN: A Flock object</span>

<span class="sd">    WHEN: I call _visual_range_mask method having two birds near each other</span>

<span class="sd">    THEN: The resulting mask has True off the diagonal</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">initial_positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
    <span class="n">flock</span><span class="o">.</span><span class="n">init_given_positions</span><span class="p">(</span><span class="n">initial_positions</span><span class="p">)</span>

    <span class="n">diagonal_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_visual_range_mask</span><span class="p">(</span><span class="n">visual_range</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span>

    <span class="n">true_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
    

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">mask</span><span class="p">[</span><span class="o">~</span><span class="n">diagonal_mask</span><span class="p">],</span> <span class="n">true_array</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_closest_index_correct_shape">
<a class="viewcode-back" href="../test.html#test.test_closest_index_correct_shape">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_closest_index_correct_shape</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _closest_index method returns a np.ndarray with the correct shape.</span>

<span class="sd">    GIVEN: A Flock object</span>

<span class="sd">    WHEN: I call _closest_index method</span>

<span class="sd">    THEN: The resulting array has shape (N_birds)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">closest_index</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_closest_index</span><span class="p">()</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">closest_index</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">200</span><span class="p">,)</span></div>




<div class="viewcode-block" id="test_closest_index_only_one_bird">
<a class="viewcode-back" href="../test.html#test.test_closest_index_only_one_bird">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_closest_index_only_one_bird</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _closest_index method returns a [0] np.ndarray if there is only one bird.</span>

<span class="sd">    GIVEN: A Flock object with one bird</span>

<span class="sd">    WHEN: I call _closest_index method</span>

<span class="sd">    THEN: The resulting array is equal to [0]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">closest_index</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_closest_index</span><span class="p">()</span>
    <span class="n">one_closest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">closest_index</span><span class="p">,</span> <span class="n">one_closest</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_closest_index_typical_usage">
<a class="viewcode-back" href="../test.html#test.test_closest_index_typical_usage">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_closest_index_typical_usage</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _closest_index method returns the expected np.ndarray given three bird with known positions.</span>

<span class="sd">    GIVEN: A Flock object with three birds with known position</span>

<span class="sd">    WHEN: I call _closest_index method</span>

<span class="sd">    THEN: The resulting array has the correct values</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">initial_positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">]])</span>
    <span class="n">flock</span><span class="o">.</span><span class="n">init_given_positions</span><span class="p">(</span><span class="n">initial_positions</span><span class="p">)</span>

    <span class="n">closest_index</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_closest_index</span><span class="p">()</span>

    <span class="n">distances</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_distances_between_birds</span><span class="p">()</span>
    <span class="n">correct_closest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">distances</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">closest_index</span><span class="p">,</span> <span class="n">correct_closest</span><span class="p">)</span></div>





<div class="viewcode-block" id="test_num_close_non_zero_correct_shape">
<a class="viewcode-back" href="../test.html#test.test_num_close_non_zero_correct_shape">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_num_close_non_zero_correct_shape</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the array returned from _num_close_non_zero has the correct shape.</span>

<span class="sd">    GIVEN: A Flock object</span>

<span class="sd">    WHEN: I call _num_close_non_zero method</span>

<span class="sd">    THEN: The returned array has shape (N_birds)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">num_close_non_zero</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_num_close_non_zero</span><span class="p">(</span><span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">num_close_non_zero</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">200</span><span class="p">,)</span></div>





<div class="viewcode-block" id="test_num_close_non_zero_only_one_bird">
<a class="viewcode-back" href="../test.html#test.test_num_close_non_zero_only_one_bird">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_num_close_non_zero_only_one_bird</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the returned array from _num_close_non_zero is [1] if only one bird is present.</span>

<span class="sd">    GIVEN: A Flock object with only one bird</span>

<span class="sd">    WHEN: I call _num_close_non_zero method</span>

<span class="sd">    THEN: The returned array is equal to [1]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">num_close_non_zero</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_num_close_non_zero</span><span class="p">(</span><span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">one_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">num_close_non_zero</span><span class="p">,</span> <span class="n">one_array</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_num_close_non_zero_zero_visual_range">
<a class="viewcode-back" href="../test.html#test.test_num_close_non_zero_zero_visual_range">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_num_close_non_zero_zero_visual_range</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _num_close_non_zero method returns an array full of ones when visual_range is 0.</span>

<span class="sd">    GIVEN: A Flock object</span>

<span class="sd">    WHEN: I call _num_close_non_zero method with visual_range = 0</span>

<span class="sd">    THEN: The resulting array is full of ones</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">num_close_non_zero</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_num_close_non_zero</span><span class="p">(</span><span class="n">visual_range</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">one_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">200</span><span class="p">,))</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">num_close_non_zero</span><span class="p">,</span> <span class="n">one_array</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_num_close_non_zero_typical_usage">
<a class="viewcode-back" href="../test.html#test.test_num_close_non_zero_typical_usage">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_num_close_non_zero_typical_usage</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _num_close_non_zero method returns an array as expected given three birds with known positions.</span>

<span class="sd">    GIVEN: A Flock object with three birds with known positions</span>

<span class="sd">    WHEN: I call _num_close_non_zero method</span>

<span class="sd">    THEN: The returned array is equal to the expected one</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">initial_positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
    <span class="n">flock</span><span class="o">.</span><span class="n">init_given_positions</span><span class="p">(</span><span class="n">initial_positions</span><span class="p">)</span>

    <span class="n">num_close_non_zero</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_num_close_non_zero</span><span class="p">(</span><span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

    <span class="n">mask</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_visual_range_mask</span><span class="p">(</span><span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

    <span class="n">expected_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">expected_array</span><span class="p">[</span><span class="n">expected_array</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">num_close_non_zero</span><span class="p">,</span> <span class="n">expected_array</span><span class="p">)</span></div>






<div class="viewcode-block" id="test_alignment_vector_correct_shape">
<a class="viewcode-back" href="../test.html#test.test_alignment_vector_correct_shape">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_alignment_vector_correct_shape</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the array returned from _alignment_vector has the correct shape.</span>

<span class="sd">    GIVEN: A Flock object</span>

<span class="sd">    WHEN: I call _alignment_vector method</span>

<span class="sd">    THEN: The returned array has shape (N_birds, 2)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">alignment_vector</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_alignment_vector</span><span class="p">(</span><span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">alignment_vector</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_alignment_vector_only_one_bird">
<a class="viewcode-back" href="../test.html#test.test_alignment_vector_only_one_bird">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_alignment_vector_only_one_bird</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the returned array from _alignment_vector is [[0],[0]] if only one bird is present.</span>

<span class="sd">    GIVEN: A Flock object with only one bird</span>

<span class="sd">    WHEN: I call _alignment_vector method</span>

<span class="sd">    THEN: The returned array is equal to [[0],[0]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">alignment_vector</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_alignment_vector</span><span class="p">(</span><span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">one_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">]])</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">alignment_vector</span><span class="p">,</span> <span class="n">one_array</span><span class="p">)</span></div>





<div class="viewcode-block" id="test_alignment_vector_zero_visual_range">
<a class="viewcode-back" href="../test.html#test.test_alignment_vector_zero_visual_range">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_alignment_vector_zero_visual_range</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _alignment_vector method returns an array full of ones when visual_range is 0.</span>

<span class="sd">    GIVEN: A Flock object</span>

<span class="sd">    WHEN: I call _alignment_vector method with visual_range = 0</span>

<span class="sd">    THEN: The resulting array is full of zeros</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">alignment_vector</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_alignment_vector</span><span class="p">(</span><span class="n">visual_range</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">zero_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">200</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">alignment_vector</span><span class="p">,</span> <span class="n">zero_array</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_alignment_vector_typical_usage">
<a class="viewcode-back" href="../test.html#test.test_alignment_vector_typical_usage">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_alignment_vector_typical_usage</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _alignment_vector method returns an array as expected given two birds with known positions and velocities.</span>

<span class="sd">    GIVEN: A Flock object with two birds with known positions and velocities</span>

<span class="sd">    WHEN: I call _alignment_vector method</span>

<span class="sd">    THEN: The returned array is equal to the expected one</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">initial_positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
    <span class="n">initial_velocities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
    <span class="n">flock</span><span class="o">.</span><span class="n">init_given_velocities</span><span class="p">(</span><span class="n">initial_velocities</span><span class="p">)</span>
    <span class="n">flock</span><span class="o">.</span><span class="n">init_given_positions</span><span class="p">(</span><span class="n">initial_positions</span><span class="p">)</span>

    <span class="n">alignment_vector</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_alignment_vector</span><span class="p">(</span><span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

    <span class="n">mask</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_visual_range_mask</span><span class="p">(</span><span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">num_close_non_zero</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_num_close_non_zero</span><span class="p">(</span><span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

    <span class="n">expected_array</span> <span class="o">=</span> <span class="p">(</span><span class="n">mask</span><span class="p">[:,</span> <span class="p">:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">flock</span><span class="o">.</span><span class="n">velocities</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">num_close_non_zero</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">alignment_vector</span><span class="p">,</span> <span class="n">expected_array</span><span class="p">)</span></div>



    

<div class="viewcode-block" id="test_coherence_vector_correct_shape">
<a class="viewcode-back" href="../test.html#test.test_coherence_vector_correct_shape">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_coherence_vector_correct_shape</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the array returned from _coherence_vector has the correct shape.</span>

<span class="sd">    GIVEN: A Flock object</span>

<span class="sd">    WHEN: I call _coherence_vector method</span>

<span class="sd">    THEN: The returned array has shape (N_birds, 2)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">coherence_vector</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_coherence_vector</span><span class="p">(</span><span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">coherence_vector</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span></div>





<div class="viewcode-block" id="test_coherence_vector_only_one_bird">
<a class="viewcode-back" href="../test.html#test.test_coherence_vector_only_one_bird">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_coherence_vector_only_one_bird</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the returned array from _coherence_vector with only one bird is equal to the opposite of his position.</span>

<span class="sd">    GIVEN: A Flock object with only one bird</span>

<span class="sd">    WHEN: I call _coherence_vector method</span>

<span class="sd">    THEN: The returned array is equal to the opposite of his position</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">initial_positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
    <span class="n">flock</span><span class="o">.</span><span class="n">init_given_positions</span><span class="p">(</span><span class="n">initial_positions</span><span class="p">)</span>

    <span class="n">coherence_vector</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_coherence_vector</span><span class="p">(</span><span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">expected_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">coherence_vector</span><span class="p">,</span> <span class="n">expected_array</span><span class="p">)</span></div>





<div class="viewcode-block" id="test_coherence_vector_zero_visual_range">
<a class="viewcode-back" href="../test.html#test.test_coherence_vector_zero_visual_range">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_coherence_vector_zero_visual_range</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _coherence_vector method returns the opposite of object.positions when visual_range == 0.</span>

<span class="sd">    GIVEN: A Flock object</span>

<span class="sd">    WHEN: I call _coherence_vector method with visual_range = 0</span>

<span class="sd">    THEN: The resulting array is equal to  - object.positions</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">coherence_vector</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_coherence_vector</span><span class="p">(</span><span class="n">visual_range</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">expected_array</span> <span class="o">=</span> <span class="o">-</span> <span class="n">flock</span><span class="o">.</span><span class="n">positions</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">coherence_vector</span><span class="p">,</span> <span class="n">expected_array</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_coherence_vector_typical_usage">
<a class="viewcode-back" href="../test.html#test.test_coherence_vector_typical_usage">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_coherence_vector_typical_usage</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _coherence_vector method returns an array as expected given two birds with known positions.</span>

<span class="sd">    GIVEN: A Flock object with two birds with known positions</span>

<span class="sd">    WHEN: I call _coherence_vector method</span>

<span class="sd">    THEN: The returned array is equal to the expected one</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">initial_positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
    <span class="n">flock</span><span class="o">.</span><span class="n">init_given_positions</span><span class="p">(</span><span class="n">initial_positions</span><span class="p">)</span>

    <span class="n">coherence_vector</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_coherence_vector</span><span class="p">(</span><span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

    <span class="n">mask</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_visual_range_mask</span><span class="p">(</span><span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">num_close_non_zero</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_num_close_non_zero</span><span class="p">(</span><span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

    <span class="n">expected_array</span> <span class="o">=</span> <span class="p">(</span><span class="n">mask</span><span class="p">[:,</span> <span class="p">:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">flock</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">num_close_non_zero</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">-</span> <span class="n">flock</span><span class="o">.</span><span class="n">positions</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">coherence_vector</span><span class="p">,</span> <span class="n">expected_array</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_edge_mask_typeerror">
<a class="viewcode-back" href="../test.html#test.test_edge_mask_typeerror">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_edge_mask_typeerror</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _edge_mask method raises a TypeError when a string is given as input.</span>

<span class="sd">    GIVEN: An invalid input type for _edge_mask method</span>

<span class="sd">    WHEN: I call _edge_mask method</span>

<span class="sd">    THEN: A TypeError is raised</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span>
                       <span class="n">match</span> <span class="o">=</span> <span class="s1">&#39;Avoid range must be a floating number&#39;</span><span class="p">,</span>
                <span class="p">):</span> 
                    <span class="n">flock</span><span class="o">.</span><span class="n">_edge_mask</span><span class="p">(</span><span class="n">avoid_range</span> <span class="o">=</span> <span class="s1">&#39;ventinove e qualcosina&#39;</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_edge_mask_valueerror">
<a class="viewcode-back" href="../test.html#test.test_edge_mask_valueerror">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_edge_mask_valueerror</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _edge_mask method raises a ValueError when a negative value is given as input.</span>

<span class="sd">    GIVEN: An invalid input value for _edge_mask method</span>

<span class="sd">    WHEN: I call _edge_mask method</span>

<span class="sd">    THEN: A ValueError is raised</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
                    <span class="n">flock</span><span class="o">.</span><span class="n">_edge_mask</span><span class="p">(</span><span class="n">avoid_range</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">)</span></div>





<div class="viewcode-block" id="test_edge_mask_correct_shape">
<a class="viewcode-back" href="../test.html#test.test_edge_mask_correct_shape">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_edge_mask_correct_shape</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the array returned from _edge_mask has the correct shape.</span>

<span class="sd">    GIVEN: A Flock object</span>

<span class="sd">    WHEN: I call _edge_mask method</span>

<span class="sd">    THEN: The returned array has shape (N_birds)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">edge_mask</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_edge_mask</span><span class="p">(</span><span class="n">avoid_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">edge_mask</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">200</span><span class="p">,)</span></div>





<div class="viewcode-block" id="test_edge_mask_zero_visual_range">
<a class="viewcode-back" href="../test.html#test.test_edge_mask_zero_visual_range">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_edge_mask_zero_visual_range</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _edge_mask method returns a mask full of False when avoid_range is 0.</span>

<span class="sd">    GIVEN: A Flock object</span>

<span class="sd">    WHEN: I call _edge_mask method with avoid_range = 0</span>

<span class="sd">    THEN: The resulting mask is full of False</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_edge_mask</span><span class="p">(</span><span class="n">avoid_range</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">zero_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">200</span><span class="p">,),</span> <span class="n">dtype</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">zero_mask</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_edge_mask_typical_usage">
<a class="viewcode-back" href="../test.html#test.test_edge_mask_typical_usage">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_edge_mask_typical_usage</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _edge_mask method returns an array as expected given two birds with known positions.</span>

<span class="sd">    GIVEN: A Flock object with two birds with known positions</span>

<span class="sd">    WHEN: I call _edge_mask method</span>

<span class="sd">    THEN: The returned array is equal to the expected one</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">initial_positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">]])</span>
    <span class="n">flock</span><span class="o">.</span><span class="n">init_given_positions</span><span class="p">(</span><span class="n">initial_positions</span><span class="p">)</span>

    <span class="n">edge_mask</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_edge_mask</span><span class="p">(</span><span class="n">avoid_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

    <span class="n">expected_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">flock</span><span class="o">.</span><span class="n">positions</span> <span class="o">-</span> <span class="n">flock</span><span class="o">.</span><span class="n">space_length</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">flock</span><span class="o">.</span><span class="n">space_length</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">-</span> <span class="mi">20</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">edge_mask</span><span class="p">,</span> <span class="n">expected_array</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_center_direction_correct_shape">
<a class="viewcode-back" href="../test.html#test.test_center_direction_correct_shape">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_center_direction_correct_shape</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the array returned from _center_direction has the correct shape.</span>

<span class="sd">    GIVEN: A Flock object</span>

<span class="sd">    WHEN: I call _center_direction method</span>

<span class="sd">    THEN: The returned array has shape (N_birds)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">edge_mask</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_center_direction</span><span class="p">()</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">edge_mask</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span></div>





<div class="viewcode-block" id="test_center_direction_normalization">
<a class="viewcode-back" href="../test.html#test.test_center_direction_normalization">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_center_direction_normalization</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _center_direction returns an array which second dimension is normalized to 1.</span>

<span class="sd">    GIVEN: A Flock object </span>

<span class="sd">    WHEN: I call _center_direction method</span>

<span class="sd">    THEN: The resulting array second dimension is normalized to one</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>

    <span class="n">unit_center_distances</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_center_direction</span><span class="p">()</span>

    <span class="n">normalized_vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">unit_center_distances</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">correct_normalization</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
    

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">normalized_vector</span><span class="p">,</span> <span class="n">correct_normalization</span><span class="p">)</span></div>





<div class="viewcode-block" id="test_center_direction_typical_usage">
<a class="viewcode-back" href="../test.html#test.test_center_direction_typical_usage">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_center_direction_typical_usage</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _center_direction returns the expected array when 4 birds with known positions are given.</span>

<span class="sd">    GIVEN: A Flock object with 4 birds with known positions</span>

<span class="sd">    WHEN: I call _center_direction method</span>

<span class="sd">    THEN: The resulting array is equal to the expected one</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">initial_positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span>
                                  <span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
                                  <span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span>
                                  <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">]])</span>
    <span class="n">flock</span><span class="o">.</span><span class="n">init_given_positions</span><span class="p">(</span><span class="n">initial_positions</span><span class="p">)</span>

    <span class="n">unit_center_distances</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_center_direction</span><span class="p">()</span>

    <span class="n">center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">flock</span><span class="o">.</span><span class="n">space_length</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">flock</span><span class="o">.</span><span class="n">space_length</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">expected_center_distances</span> <span class="o">=</span> <span class="n">center</span> <span class="o">-</span> <span class="n">flock</span><span class="o">.</span><span class="n">positions</span>

    <span class="n">expected_center_distances</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">expected_center_distances</span><span class="o">==</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1e-5</span><span class="p">,</span> <span class="mf">1e-5</span><span class="p">]</span>
    <span class="n">expected_center_distances</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">expected_center_distances</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span><span class="kc">None</span><span class="p">]</span>
    
    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">unit_center_distances</span><span class="p">,</span> <span class="n">expected_center_distances</span><span class="p">)</span></div>





<div class="viewcode-block" id="test_separation_force_type_error_separation">
<a class="viewcode-back" href="../test.html#test.test_separation_force_type_error_separation">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_separation_force_type_error_separation</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _separation_force method raises an error when a string is given as input for separation argument.</span>

<span class="sd">    GIVEN: An invalid input type for separation in _separation_force method</span>

<span class="sd">    WHEN: I call _separation_force method</span>

<span class="sd">    THEN: A TypeError is raised</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span>
                       <span class="n">match</span> <span class="o">=</span> <span class="s1">&#39;Separation parameter must be a floating number&#39;</span><span class="p">,</span>
                <span class="p">):</span> 
                    <span class="n">flock</span><span class="o">.</span><span class="n">_separation_force</span><span class="p">(</span><span class="n">separation</span> <span class="o">=</span> <span class="s1">&#39;uno&#39;</span><span class="p">,</span> <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span></div>





<div class="viewcode-block" id="test_separation_force_valueerror_separation">
<a class="viewcode-back" href="../test.html#test.test_separation_force_valueerror_separation">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_separation_force_valueerror_separation</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _separation_force method raises a ValueError when a negative value for separation is given as input.</span>

<span class="sd">    GIVEN: An invalid input value for separation argument in _separation_force method</span>

<span class="sd">    WHEN: I call _separation_force method</span>

<span class="sd">    THEN: A ValueError is raised</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span>
                       <span class="n">match</span> <span class="o">=</span> <span class="s1">&#39;Separation parameter must be &gt;= 0&#39;</span>
                       <span class="p">):</span>
                        <span class="n">flock</span><span class="o">.</span><span class="n">_separation_force</span><span class="p">(</span><span class="n">separation</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span></div>





<div class="viewcode-block" id="test_separation_force_correct_shape">
<a class="viewcode-back" href="../test.html#test.test_separation_force_correct_shape">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_separation_force_correct_shape</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the array returned from _separation_force has the correct shape.</span>

<span class="sd">    GIVEN: A Flock object</span>

<span class="sd">    WHEN: I call _separation_force method</span>

<span class="sd">    THEN: The returned array has shape (N_birds, 2)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">separation_force</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_separation_force</span><span class="p">(</span><span class="n">separation</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">separation_force</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span></div>





<div class="viewcode-block" id="test_separation_force_only_one_bird">
<a class="viewcode-back" href="../test.html#test.test_separation_force_only_one_bird">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_separation_force_only_one_bird</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the returned array from _separation_force method with only one bird is equal to [0].</span>

<span class="sd">    GIVEN: A Flock object with only one bird</span>

<span class="sd">    WHEN: I call _separation_force method</span>

<span class="sd">    THEN: The returned array is equal to [0]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>

    <span class="n">separation_force</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_separation_force</span><span class="p">(</span><span class="n">separation</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">expected_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">separation_force</span><span class="p">,</span> <span class="n">expected_array</span><span class="p">)</span></div>





<div class="viewcode-block" id="test_separation_force_zero_separation">
<a class="viewcode-back" href="../test.html#test.test_separation_force_zero_separation">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_separation_force_zero_separation</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the returned array from _separation_force method with separation = 0 is full of zeros.</span>

<span class="sd">    GIVEN: A Flock object </span>

<span class="sd">    WHEN: I call _separation_force method with separation = 0</span>

<span class="sd">    THEN: The returned array is full of zeros</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>

    <span class="n">separation_force</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_separation_force</span><span class="p">(</span><span class="n">separation</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">expected_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">200</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">separation_force</span><span class="p">,</span> <span class="n">expected_array</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_separation_force_zero_visual_range">
<a class="viewcode-back" href="../test.html#test.test_separation_force_zero_visual_range">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_separation_force_zero_visual_range</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the returned array from _separation_force method with visual_range = 0 is full of zeros.</span>

<span class="sd">    GIVEN: A Flock object </span>

<span class="sd">    WHEN: I call _separation_force method with visual_range = 0</span>

<span class="sd">    THEN: The returned array is full of zeros</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>

    <span class="n">separation_force</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_separation_force</span><span class="p">(</span><span class="n">separation</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">expected_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">200</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">separation_force</span><span class="p">,</span> <span class="n">expected_array</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_separation_force_typical_usage">
<a class="viewcode-back" href="../test.html#test.test_separation_force_typical_usage">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_separation_force_typical_usage</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _separation_force returns the expected array.</span>

<span class="sd">    GIVEN: A Flock object </span>

<span class="sd">    WHEN: I call _separation_force method</span>

<span class="sd">    THEN: The resulting array is equal to the expected one</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>

    <span class="n">separation_force</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_separation_force</span><span class="p">(</span><span class="n">separation</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

    <span class="n">unit_directions</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_directions_unitary_vectors</span><span class="p">()</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_visual_range_mask</span><span class="p">(</span><span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">closest_index</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_closest_index</span><span class="p">()</span>
    <span class="n">expected_separation_force</span> <span class="o">=</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">unit_directions</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">unit_directions</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">closest_index</span><span class="p">]</span> <span class="o">*</span> <span class="n">mask</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">closest_index</span><span class="p">][:,</span><span class="kc">None</span><span class="p">]</span>
    
    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">separation_force</span><span class="p">,</span> <span class="n">expected_separation_force</span><span class="p">)</span></div>





<div class="viewcode-block" id="test_alignment_force_type_error_separation">
<a class="viewcode-back" href="../test.html#test.test_alignment_force_type_error_separation">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_alignment_force_type_error_separation</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _alignment_force method raises an error when a string is given as input for alignment argument.</span>

<span class="sd">    GIVEN: An invalid input type for alignment in _alignment_force method</span>

<span class="sd">    WHEN: I call _alignment_force method</span>

<span class="sd">    THEN: A TypeError is raised</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span>
                       <span class="n">match</span> <span class="o">=</span> <span class="s1">&#39;Alignment parameter must be a floating number&#39;</span><span class="p">,</span>
                <span class="p">):</span> 
                    <span class="n">flock</span><span class="o">.</span><span class="n">_alignment_force</span><span class="p">(</span><span class="n">alignment</span> <span class="o">=</span> <span class="s1">&#39;uno&#39;</span><span class="p">,</span> <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span></div>






<div class="viewcode-block" id="test_alignment_force_valueerror_separation">
<a class="viewcode-back" href="../test.html#test.test_alignment_force_valueerror_separation">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_alignment_force_valueerror_separation</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _alignment_force method raises a ValueError when a negative value for alignment is given as input.</span>

<span class="sd">    GIVEN: An invalid input value for alignment argument in _alignment_force method</span>

<span class="sd">    WHEN: I call _alignment_force method</span>

<span class="sd">    THEN: A ValueError is raised</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span>
                       <span class="n">match</span> <span class="o">=</span> <span class="s1">&#39;Alignment parameter must be &gt;= 0&#39;</span>
                       <span class="p">):</span>
                        <span class="n">flock</span><span class="o">.</span><span class="n">_alignment_force</span><span class="p">(</span><span class="n">alignment</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span></div>





<div class="viewcode-block" id="test_alignment_force_correct_shape">
<a class="viewcode-back" href="../test.html#test.test_alignment_force_correct_shape">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_alignment_force_correct_shape</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the array returned from _alignment_force has the correct shape.</span>

<span class="sd">    GIVEN: A Flock object</span>

<span class="sd">    WHEN: I call _alignment_force method</span>

<span class="sd">    THEN: The returned array has shape (N_birds, 2)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">alignment_force</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_alignment_force</span><span class="p">(</span><span class="n">alignment</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">alignment_force</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_alignment_force_only_one_bird">
<a class="viewcode-back" href="../test.html#test.test_alignment_force_only_one_bird">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_alignment_force_only_one_bird</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the returned array from _alignment_force method with only one bird is equal to [0].</span>

<span class="sd">    GIVEN: A Flock object with only one bird</span>

<span class="sd">    WHEN: I call _alignment_force method</span>

<span class="sd">    THEN: The returned array is equal to [0]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>

    <span class="n">alignment_force</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_alignment_force</span><span class="p">(</span><span class="n">alignment</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">expected_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">alignment_force</span><span class="p">,</span> <span class="n">expected_array</span><span class="p">)</span></div>





<div class="viewcode-block" id="test_alignment_force_zero_separation">
<a class="viewcode-back" href="../test.html#test.test_alignment_force_zero_separation">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_alignment_force_zero_separation</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the returned array from _alignment_force method with alignment = 0 is full of zeros.</span>

<span class="sd">    GIVEN: A Flock object </span>

<span class="sd">    WHEN: I call _alignment_force method with alignment = 0</span>

<span class="sd">    THEN: The returned array is full of zeros</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>

    <span class="n">alignment_force</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_alignment_force</span><span class="p">(</span><span class="n">alignment</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">expected_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">200</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">alignment_force</span><span class="p">,</span> <span class="n">expected_array</span><span class="p">)</span></div>





<div class="viewcode-block" id="test_alignment_force_zero_visual_range">
<a class="viewcode-back" href="../test.html#test.test_alignment_force_zero_visual_range">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_alignment_force_zero_visual_range</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the returned array from _alignment_force method with visual_range = 0 is full of zeros.</span>

<span class="sd">    GIVEN: A Flock object </span>

<span class="sd">    WHEN: I call _alignment_force method with visual_range = 0</span>

<span class="sd">    THEN: The returned array is full of zeros</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>

    <span class="n">alignment_force</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_alignment_force</span><span class="p">(</span><span class="n">alignment</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">expected_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">200</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">alignment_force</span><span class="p">,</span> <span class="n">expected_array</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_alignment_force_typical_usage">
<a class="viewcode-back" href="../test.html#test.test_alignment_force_typical_usage">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_alignment_force_typical_usage</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _alignment_force returns the expected array.</span>

<span class="sd">    GIVEN: A Flock object </span>

<span class="sd">    WHEN: I call _alignment_force method</span>

<span class="sd">    THEN: The resulting array is equal to the expected one</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>

    <span class="n">alignment_force</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_alignment_force</span><span class="p">(</span><span class="n">alignment</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

    <span class="n">aligment_vector</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_alignment_vector</span><span class="p">(</span><span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">aligment_lengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">aligment_vector</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">aligment_lengths</span><span class="p">[</span><span class="n">aligment_lengths</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">expected_force_alignment</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">aligment_vector</span> <span class="o">/</span> <span class="n">aligment_lengths</span><span class="p">[:,</span><span class="kc">None</span><span class="p">]</span>
    
    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">alignment_force</span><span class="p">,</span> <span class="n">expected_force_alignment</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_coherence_force_type_error_coherence">
<a class="viewcode-back" href="../test.html#test.test_coherence_force_type_error_coherence">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_coherence_force_type_error_coherence</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _coherence_force method raises an error when a string is given as input for coherence argument.</span>

<span class="sd">    GIVEN: An invalid input type for coherence in _coherence_force method</span>

<span class="sd">    WHEN: I call _coherence_force method</span>

<span class="sd">    THEN: A TypeError is raised</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span>
                       <span class="n">match</span> <span class="o">=</span> <span class="s1">&#39;Coherence parameter must be a floating number&#39;</span><span class="p">,</span>
                <span class="p">):</span> 
                    <span class="n">flock</span><span class="o">.</span><span class="n">_coherence_force</span><span class="p">(</span><span class="n">coherence</span> <span class="o">=</span> <span class="s1">&#39;ho sceso dandoti il braccio almeno un milione di scale&#39;</span><span class="p">,</span> <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span></div>





<div class="viewcode-block" id="test_coherence_force_valueerror_coherence">
<a class="viewcode-back" href="../test.html#test.test_coherence_force_valueerror_coherence">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_coherence_force_valueerror_coherence</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _coherence_force method raises a ValueError when a negative value for coherence is given as input.</span>

<span class="sd">    GIVEN: An invalid input value for coherence argument in _coherence_force method</span>

<span class="sd">    WHEN: I call _coherence_force method</span>

<span class="sd">    THEN: A ValueError is raised</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span>
                       <span class="n">match</span> <span class="o">=</span> <span class="s1">&#39;Coherence parameter must be &gt;= 0&#39;</span>
                       <span class="p">):</span>
                        <span class="n">flock</span><span class="o">.</span><span class="n">_coherence_force</span><span class="p">(</span><span class="n">coherence</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_coherence_force_correct_shape">
<a class="viewcode-back" href="../test.html#test.test_coherence_force_correct_shape">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_coherence_force_correct_shape</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the array returned from _coherence_force has the correct shape.</span>

<span class="sd">    GIVEN: A Flock object</span>

<span class="sd">    WHEN: I call _coherence_force method</span>

<span class="sd">    THEN: The returned array has shape (N_birds, 2)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">coherence_force</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_coherence_force</span><span class="p">(</span><span class="n">coherence</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">coherence_force</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span></div>





<div class="viewcode-block" id="test_coherence_force_only_one_bird">
<a class="viewcode-back" href="../test.html#test.test_coherence_force_only_one_bird">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_coherence_force_only_one_bird</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the returned array from _coherence_force method with only one bird is equal to the expected one.</span>

<span class="sd">    GIVEN: A Flock object with only one bird</span>

<span class="sd">    WHEN: I call _coherence_force method</span>

<span class="sd">    THEN: The returned array is equal to the expected one</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>

    <span class="n">coherence_force</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_coherence_force</span><span class="p">(</span><span class="n">coherence</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">expected_array</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">flock</span><span class="o">.</span><span class="n">positions</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">flock</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">coherence_force</span><span class="p">,</span> <span class="n">expected_array</span><span class="p">)</span></div>






<div class="viewcode-block" id="test_coherence_force_zero_separation">
<a class="viewcode-back" href="../test.html#test.test_coherence_force_zero_separation">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_coherence_force_zero_separation</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the returned array from _coherence_force method with coherence = 0 is full of zeros.</span>

<span class="sd">    GIVEN: A Flock object </span>

<span class="sd">    WHEN: I call _coherence_force method with coherence = 0</span>

<span class="sd">    THEN: The returned array is full of zeros</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>

    <span class="n">coherence_force</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_coherence_force</span><span class="p">(</span><span class="n">coherence</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">expected_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">200</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">coherence_force</span><span class="p">,</span> <span class="n">expected_array</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_coherence_force_zero_visual_range">
<a class="viewcode-back" href="../test.html#test.test_coherence_force_zero_visual_range">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_coherence_force_zero_visual_range</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the returned array from _coherence_force method with visual_range = 0 is equal to the expected one.</span>

<span class="sd">    GIVEN: A Flock object </span>

<span class="sd">    WHEN: I call _coherence_force method with visual_range = 0</span>

<span class="sd">    THEN: The returned array is equal to the expected one</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>

    <span class="n">coherence_force</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_coherence_force</span><span class="p">(</span><span class="n">coherence</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">expected_array</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">flock</span><span class="o">.</span><span class="n">positions</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">flock</span><span class="o">.</span><span class="n">positions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span><span class="kc">None</span><span class="p">]</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">coherence_force</span><span class="p">,</span> <span class="n">expected_array</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_coherence_force_typical_usage">
<a class="viewcode-back" href="../test.html#test.test_coherence_force_typical_usage">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_coherence_force_typical_usage</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _coherence_force returns the expected array.</span>

<span class="sd">    GIVEN: A Flock object </span>

<span class="sd">    WHEN: I call _coherence_force method</span>

<span class="sd">    THEN: The resulting array is equal to the expected one</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>

    <span class="n">coherence_force</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_coherence_force</span><span class="p">(</span><span class="n">coherence</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

    <span class="n">coherence_vector</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_coherence_vector</span><span class="p">(</span><span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">expected_force_coherence</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">coherence_vector</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">coherence_vector</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span><span class="kc">None</span><span class="p">]</span>
    
    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">coherence_force</span><span class="p">,</span> <span class="n">expected_force_coherence</span><span class="p">)</span></div>





<div class="viewcode-block" id="test_avoidance_force_type_error_avoidance">
<a class="viewcode-back" href="../test.html#test.test_avoidance_force_type_error_avoidance">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_avoidance_force_type_error_avoidance</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _avoidance_force method raises an error when a string is given as input for avoidance argument.</span>

<span class="sd">    GIVEN: An invalid input type for avoidance in _avoidance_force method</span>

<span class="sd">    WHEN: I call _avoidance_force method</span>

<span class="sd">    THEN: A TypeError is raised</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span>
                       <span class="n">match</span> <span class="o">=</span> <span class="s1">&#39;Avoidance parameter must be a floating number&#39;</span><span class="p">,</span>
                <span class="p">):</span> 
                    <span class="n">flock</span><span class="o">.</span><span class="n">_avoidance_force</span><span class="p">(</span><span class="n">avoidance</span> <span class="o">=</span> <span class="s1">&#39;e ora che non ci sei è il vuoto ad ogni gradino&#39;</span><span class="p">,</span> <span class="n">avoid_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span></div>





<div class="viewcode-block" id="test_avoidance_force_valueerror_avoidance">
<a class="viewcode-back" href="../test.html#test.test_avoidance_force_valueerror_avoidance">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_avoidance_force_valueerror_avoidance</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _avoidance_force method raises a ValueError when a negative value for avoidance is given as input.</span>

<span class="sd">    GIVEN: An invalid input value for avoidance argument in _avoidance_force method</span>

<span class="sd">    WHEN: I call _avoidance_force method</span>

<span class="sd">    THEN: A ValueError is raised</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span>
                       <span class="n">match</span> <span class="o">=</span> <span class="s1">&#39;Avoidance parameter must be &gt;= 0&#39;</span>
                       <span class="p">):</span>
                        <span class="n">flock</span><span class="o">.</span><span class="n">_avoidance_force</span><span class="p">(</span><span class="n">avoidance</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">avoid_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span></div>





<div class="viewcode-block" id="test_avoidance_force_correct_shape">
<a class="viewcode-back" href="../test.html#test.test_avoidance_force_correct_shape">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_avoidance_force_correct_shape</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the array returned from _avoidance_force has the correct shape.</span>

<span class="sd">    GIVEN: A Flock object</span>

<span class="sd">    WHEN: I call _avoidance_force method</span>

<span class="sd">    THEN: The returned array has shape (N_birds, 2)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">avoidance_force</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_avoidance_force</span><span class="p">(</span><span class="n">avoidance</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">avoid_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">avoidance_force</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span></div>






<div class="viewcode-block" id="test_avoidance_force_zero_separation">
<a class="viewcode-back" href="../test.html#test.test_avoidance_force_zero_separation">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_avoidance_force_zero_separation</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the returned array from _avoidance_force method with avoidance = 0 is full of zeros.</span>

<span class="sd">    GIVEN: A Flock object </span>

<span class="sd">    WHEN: I call _avoidance_force method with avoidance = 0</span>

<span class="sd">    THEN: The returned array is full of zeros</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>

    <span class="n">avoidance_force</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_avoidance_force</span><span class="p">(</span><span class="n">avoidance</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">avoid_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">expected_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">200</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">avoidance_force</span><span class="p">,</span> <span class="n">expected_array</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_avoidance_force_zero_avoid_range">
<a class="viewcode-back" href="../test.html#test.test_avoidance_force_zero_avoid_range">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_avoidance_force_zero_avoid_range</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the returned array from _avoidance_force method with avoid_range = 0 is equal to the expected one.</span>

<span class="sd">    GIVEN: A Flock object </span>

<span class="sd">    WHEN: I call _avoidance_force method with avoid_range = 0</span>

<span class="sd">    THEN: The returned array is equal to the expected one</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>

    <span class="n">avoidance_force</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_avoidance_force</span><span class="p">(</span><span class="n">avoidance</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">avoid_range</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">expected_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">200</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">avoidance_force</span><span class="p">,</span> <span class="n">expected_array</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_avoidance_force_typical_usage">
<a class="viewcode-back" href="../test.html#test.test_avoidance_force_typical_usage">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_avoidance_force_typical_usage</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _avoidance_force returns the expected array.</span>

<span class="sd">    GIVEN: A Flock object </span>

<span class="sd">    WHEN: I call _avoidance_force method</span>

<span class="sd">    THEN: The resulting array is equal to the expected one</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>

    <span class="n">avoidance_force</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_avoidance_force</span><span class="p">(</span><span class="n">avoidance</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">avoid_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

    <span class="n">edge_mask</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_edge_mask</span><span class="p">(</span><span class="n">avoid_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">center_directions</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_center_direction</span><span class="p">()</span>
    <span class="n">expected_avoidance_force</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">center_directions</span> <span class="o">*</span> <span class="n">edge_mask</span><span class="p">[:,</span><span class="kc">None</span><span class="p">]</span>
    
    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">avoidance_force</span><span class="p">,</span> <span class="n">expected_avoidance_force</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_compute_forces_changes_attribute_last_forces">
<a class="viewcode-back" href="../test.html#test.test_compute_forces_changes_attribute_last_forces">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_compute_forces_changes_attribute_last_forces</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _compute_forces method overwrite the last_forces object attribute.</span>

<span class="sd">    GIVEN: A Flock object </span>

<span class="sd">    WHEN: I call _compute_forces method</span>

<span class="sd">    THEN: The last_forces object attribute is overwritten</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">initial_forces</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">last_forces</span>
    <span class="n">flock</span><span class="o">.</span><span class="n">_compute_forces</span><span class="p">(</span><span class="n">separation</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> 
                          <span class="n">alignment</span> <span class="o">=</span> <span class="mf">2.2</span><span class="p">,</span> 
                          <span class="n">coherence</span> <span class="o">=</span> <span class="mf">2.2</span><span class="p">,</span> 
                          <span class="n">avoidance</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> 
                          <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> 
                          <span class="n">avoid_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
    
    <span class="n">final_forces</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">last_forces</span>

    <span class="k">assert</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">initial_forces</span><span class="p">,</span> <span class="n">final_forces</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_compute_forces_zero_force_parameters">
<a class="viewcode-back" href="../test.html#test.test_compute_forces_zero_force_parameters">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_compute_forces_zero_force_parameters</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the last_forces object attribute is full of zeros after calling _compute_forces when all the force parameters are 0.</span>

<span class="sd">    GIVEN: A Flock object</span>

<span class="sd">    WHEN: I call _compute_forces method with all the force parameters equal to 0</span>

<span class="sd">    THEN: The object last_forces attribute is full of zeros</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">flock</span><span class="o">.</span><span class="n">_compute_forces</span><span class="p">(</span><span class="n">separation</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> 
                          <span class="n">alignment</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> 
                          <span class="n">coherence</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> 
                          <span class="n">avoidance</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> 
                          <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> 
                          <span class="n">avoid_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
    
    <span class="n">zero_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">200</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">flock</span><span class="o">.</span><span class="n">last_forces</span><span class="p">,</span> <span class="n">zero_array</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_compute_forces_zero_range_parameters">
<a class="viewcode-back" href="../test.html#test.test_compute_forces_zero_range_parameters">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_compute_forces_zero_range_parameters</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the last_forces object attribute is equal to the coherence force after calling _compute_forces when all the range parameters are 0.</span>

<span class="sd">    GIVEN: A Flock object</span>

<span class="sd">    WHEN: I call _compute_forces method with all the range parameters equal to 0</span>

<span class="sd">    THEN: The object last_forces attribute is equal to the coherence force</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">flock</span><span class="o">.</span><span class="n">_compute_forces</span><span class="p">(</span><span class="n">separation</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> 
                          <span class="n">alignment</span> <span class="o">=</span> <span class="mf">2.2</span><span class="p">,</span> 
                          <span class="n">coherence</span> <span class="o">=</span> <span class="mf">2.2</span><span class="p">,</span> 
                          <span class="n">avoidance</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> 
                          <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> 
                          <span class="n">avoid_range</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    
    <span class="n">coherence_force</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_coherence_force</span><span class="p">(</span><span class="n">coherence</span> <span class="o">=</span> <span class="mf">2.2</span><span class="p">,</span> <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">flock</span><span class="o">.</span><span class="n">last_forces</span><span class="p">,</span> <span class="n">coherence_force</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_compute_forces_typical_usage">
<a class="viewcode-back" href="../test.html#test.test_compute_forces_typical_usage">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_compute_forces_typical_usage</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _compute_forces returns the expected array.</span>

<span class="sd">    GIVEN: A Flock object </span>

<span class="sd">    WHEN: I call _compute_forces method</span>

<span class="sd">    THEN: The resulting array is equal to the expected one</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>

    <span class="n">flock</span><span class="o">.</span><span class="n">_compute_forces</span><span class="p">(</span><span class="n">separation</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> 
                          <span class="n">alignment</span> <span class="o">=</span> <span class="mf">2.2</span><span class="p">,</span> 
                          <span class="n">coherence</span> <span class="o">=</span> <span class="mf">2.</span><span class="p">,</span> 
                          <span class="n">avoidance</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> 
                          <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> 
                          <span class="n">avoid_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

    <span class="n">force_separation</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_separation_force</span><span class="p">(</span><span class="n">separation</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span>
    <span class="n">force_alignment</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_alignment_force</span><span class="p">(</span><span class="n">alignment</span> <span class="o">=</span> <span class="mf">2.2</span><span class="p">,</span> <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span>
    <span class="n">force_coherence</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_coherence_force</span><span class="p">(</span><span class="n">coherence</span> <span class="o">=</span> <span class="mf">2.</span><span class="p">,</span> <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span>
    <span class="n">force_avoidance</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_avoidance_force</span><span class="p">(</span><span class="n">avoidance</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">avoid_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>

    <span class="n">expected_last_forces</span> <span class="o">=</span> <span class="n">force_coherence</span> <span class="o">+</span> <span class="n">force_avoidance</span> <span class="o">+</span> <span class="n">force_alignment</span> <span class="o">+</span> <span class="n">force_separation</span>
    
    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">flock</span><span class="o">.</span><span class="n">last_forces</span><span class="p">,</span> <span class="n">expected_last_forces</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_update_state_type_error_dt">
<a class="viewcode-back" href="../test.html#test.test_update_state_type_error_dt">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_update_state_type_error_dt</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _update_state method raises an error when a string is given as input for dt argument.</span>

<span class="sd">    GIVEN: An invalid input type for dt in _update_state method</span>

<span class="sd">    WHEN: I call _update_state method</span>

<span class="sd">    THEN: A TypeError is raised</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span>
                       <span class="n">match</span> <span class="o">=</span> <span class="s1">&#39;Time step dt must be a floating number&#39;</span><span class="p">,</span>
                <span class="p">):</span> 
                    <span class="n">flock</span><span class="o">.</span><span class="n">_update_state</span><span class="p">(</span><span class="n">dt</span> <span class="o">=</span> <span class="s1">&#39;0.5&#39;</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_update_state_value_error_dt">
<a class="viewcode-back" href="../test.html#test.test_update_state_value_error_dt">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_update_state_value_error_dt</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _update_state method raises an error when a negative value is given as input for dt argument.</span>

<span class="sd">    GIVEN: An invalid value for dt in _update_state method</span>

<span class="sd">    WHEN: I call _update_state method</span>

<span class="sd">    THEN: A ValueError is raised</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span>
                       <span class="n">match</span> <span class="o">=</span> <span class="s1">&#39;Time step dt must be &gt; 0&#39;</span><span class="p">,</span>
                <span class="p">):</span> 
                    <span class="n">flock</span><span class="o">.</span><span class="n">_update_state</span><span class="p">(</span><span class="n">dt</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_update_state_changes_positions">
<a class="viewcode-back" href="../test.html#test.test_update_state_changes_positions">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_update_state_changes_positions</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _update_state method changed the internal attribute positions.</span>

<span class="sd">    GIVEN: A Flock object</span>

<span class="sd">    WHEN: I call _update_state method</span>

<span class="sd">    THEN: The object.positions array is changed</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">initial_positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">flock</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span>

    <span class="n">flock</span><span class="o">.</span><span class="n">_update_state</span><span class="p">(</span><span class="n">dt</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">final_positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">flock</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span>

    <span class="k">assert</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">initial_positions</span><span class="p">,</span> <span class="n">final_positions</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_update_state_changes_velocities">
<a class="viewcode-back" href="../test.html#test.test_update_state_changes_velocities">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_update_state_changes_velocities</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the _update_state method changed the internal attribute velocities.</span>

<span class="sd">    GIVEN: A Flock object</span>

<span class="sd">    WHEN: I call _update_state method</span>

<span class="sd">    THEN: The object.velocities array is changed</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">initial_velocities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">flock</span><span class="o">.</span><span class="n">velocities</span><span class="p">)</span>

    <span class="n">flock</span><span class="o">.</span><span class="n">_update_state</span><span class="p">(</span><span class="n">dt</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">final_velocities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">flock</span><span class="o">.</span><span class="n">velocities</span><span class="p">)</span>

    <span class="k">assert</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">initial_velocities</span><span class="p">,</span> <span class="n">final_velocities</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_update_state_positions_under_zero_force_parameters">
<a class="viewcode-back" href="../test.html#test.test_update_state_positions_under_zero_force_parameters">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_update_state_positions_under_zero_force_parameters</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the positions change as expected if all the force parameters are set to 0, i.e. the total force is 0, in the _update_state method.</span>

<span class="sd">    GIVEN: A Flock object</span>

<span class="sd">    WHEN: I call _update_state method with all the force parameters set to 0</span>

<span class="sd">    THEN: The object.positions array changes as expected</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">initial_velocities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">flock</span><span class="o">.</span><span class="n">velocities</span><span class="p">)</span>
    <span class="n">correct_final_positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">flock</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span>

    <span class="n">flock</span><span class="o">.</span><span class="n">_update_state</span><span class="p">(</span><span class="n">dt</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
                        <span class="n">separation</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> 
                        <span class="n">alignment</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> 
                        <span class="n">coherence</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> 
                        <span class="n">avoidance</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> 
                        <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> 
                        <span class="n">avoid_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
    
    <span class="n">final_positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">flock</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span>

    <span class="n">correct_final_positions</span> <span class="o">+=</span> <span class="n">initial_velocities</span><span class="o">*</span><span class="mf">0.5</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">final_positions</span><span class="p">,</span> <span class="n">correct_final_positions</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_update_state_velocities_under_zero_force_parameters">
<a class="viewcode-back" href="../test.html#test.test_update_state_velocities_under_zero_force_parameters">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_update_state_velocities_under_zero_force_parameters</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the velocities change as expected if all the force parameters are set to 0, i.e. the total force is 0, in the _update_state method.</span>

<span class="sd">    GIVEN: A Flock object</span>

<span class="sd">    WHEN: I call _update_state method with all the force parameters set to 0</span>

<span class="sd">    THEN: The object.velocities array changes as expected</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">initial_velocities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">flock</span><span class="o">.</span><span class="n">velocities</span><span class="p">)</span>

    <span class="n">flock</span><span class="o">.</span><span class="n">_update_state</span><span class="p">(</span><span class="n">dt</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
                        <span class="n">separation</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> 
                        <span class="n">alignment</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> 
                        <span class="n">coherence</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> 
                        <span class="n">avoidance</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> 
                        <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> 
                        <span class="n">avoid_range</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
    
    <span class="n">final_velocities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">flock</span><span class="o">.</span><span class="n">velocities</span><span class="p">)</span>

    <span class="n">speed_limit_factors</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_speed_limit_factors</span><span class="p">()</span>
    <span class="n">initial_velocities</span> <span class="o">=</span> <span class="n">initial_velocities</span><span class="o">/</span> <span class="n">speed_limit_factors</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>

    <span class="n">correct_final_velocities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">initial_velocities</span><span class="p">,</span> <span class="o">-</span><span class="n">flock</span><span class="o">.</span><span class="n">max_speed</span><span class="p">,</span> <span class="n">flock</span><span class="o">.</span><span class="n">max_speed</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">final_velocities</span><span class="p">,</span> <span class="n">correct_final_velocities</span><span class="p">)</span></div>





<div class="viewcode-block" id="test_update_state_typical_usage_positions">
<a class="viewcode-back" href="../test.html#test.test_update_state_typical_usage_positions">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_update_state_typical_usage_positions</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that positions attribute of the Flock object is correctly updated by _update_state method given typical arguments values.</span>

<span class="sd">    GIVEN: A Flock object </span>

<span class="sd">    WHEN: I call _update_state method given typical arguments values</span>

<span class="sd">    THEN: The positions attribute of the Flock object is correctly updated</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>

    <span class="n">flock</span><span class="o">.</span><span class="n">_update_state</span><span class="p">(</span><span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
                        <span class="n">separation</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> 
                        <span class="n">alignment</span> <span class="o">=</span> <span class="mf">2.2</span><span class="p">,</span> 
                        <span class="n">coherence</span> <span class="o">=</span> <span class="mf">2.2</span><span class="p">,</span>
                        <span class="n">avoidance</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
                        <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> 
                        <span class="n">avoid_range</span> <span class="o">=</span> <span class="mi">40</span><span class="p">)</span>
    
    <span class="n">final_positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">flock</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span>


    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>

    <span class="n">flock</span><span class="o">.</span><span class="n">_compute_forces</span><span class="p">(</span><span class="n">separation</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> 
                                 <span class="n">alignment</span> <span class="o">=</span> <span class="mf">2.2</span><span class="p">,</span> 
                                 <span class="n">coherence</span> <span class="o">=</span> <span class="mf">2.2</span><span class="p">,</span>
                                 <span class="n">avoidance</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
                                 <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> 
                                 <span class="n">avoid_range</span> <span class="o">=</span> <span class="mi">40</span><span class="p">)</span>
        
    <span class="n">flock</span><span class="o">.</span><span class="n">positions</span> <span class="o">+=</span> <span class="n">flock</span><span class="o">.</span><span class="n">velocities</span> <span class="o">*</span><span class="mf">0.1</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">flock</span><span class="o">.</span><span class="n">last_forces</span><span class="o">*</span><span class="mf">0.1</span><span class="o">*</span><span class="mf">0.1</span>
    
    <span class="n">correct_final_positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">flock</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">final_positions</span><span class="p">,</span> <span class="n">correct_final_positions</span><span class="p">)</span></div>





<div class="viewcode-block" id="test_update_state_typical_usage_velocities">
<a class="viewcode-back" href="../test.html#test.test_update_state_typical_usage_velocities">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_update_state_typical_usage_velocities</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that velocities attribute of the Flock object is correctly updated by _update_state method given typical arguments values.</span>

<span class="sd">    GIVEN: A Flock object </span>

<span class="sd">    WHEN: I call _update_state method given typical arguments values</span>

<span class="sd">    THEN: The velocities attribute of the Flock object is correctly updated</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>

    <span class="n">flock</span><span class="o">.</span><span class="n">_update_state</span><span class="p">(</span><span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
                        <span class="n">separation</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> 
                        <span class="n">alignment</span> <span class="o">=</span> <span class="mf">2.2</span><span class="p">,</span> 
                        <span class="n">coherence</span> <span class="o">=</span> <span class="mf">2.2</span><span class="p">,</span>
                        <span class="n">avoidance</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
                        <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> 
                        <span class="n">avoid_range</span> <span class="o">=</span> <span class="mi">40</span><span class="p">)</span>
    
    <span class="n">final_velocities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">flock</span><span class="o">.</span><span class="n">velocities</span><span class="p">)</span>


    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>

    <span class="n">flock</span><span class="o">.</span><span class="n">_compute_forces</span><span class="p">(</span><span class="n">separation</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> 
                                 <span class="n">alignment</span> <span class="o">=</span> <span class="mf">2.2</span><span class="p">,</span> 
                                 <span class="n">coherence</span> <span class="o">=</span> <span class="mf">2.2</span><span class="p">,</span>
                                 <span class="n">avoidance</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
                                 <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> 
                                 <span class="n">avoid_range</span> <span class="o">=</span> <span class="mi">40</span><span class="p">)</span>
        
    <span class="n">flock</span><span class="o">.</span><span class="n">velocities</span> <span class="o">+=</span> <span class="n">flock</span><span class="o">.</span><span class="n">last_forces</span><span class="o">*</span><span class="mf">0.1</span>
    <span class="n">speed_limit_factors</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">_speed_limit_factors</span><span class="p">()</span>
    <span class="n">flock</span><span class="o">.</span><span class="n">velocities</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">velocities</span> <span class="o">/</span> <span class="n">speed_limit_factors</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">flock</span><span class="o">.</span><span class="n">velocities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">flock</span><span class="o">.</span><span class="n">velocities</span><span class="p">,</span> <span class="o">-</span><span class="n">flock</span><span class="o">.</span><span class="n">max_speed</span><span class="p">,</span> <span class="n">flock</span><span class="o">.</span><span class="n">max_speed</span><span class="p">)</span>

    <span class="n">correct_final_velocities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">flock</span><span class="o">.</span><span class="n">velocities</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">final_velocities</span><span class="p">,</span> <span class="n">correct_final_velocities</span><span class="p">)</span></div>





<div class="viewcode-block" id="test_simulate_type_error_num_time_steps">
<a class="viewcode-back" href="../test.html#test.test_simulate_type_error_num_time_steps">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_simulate_type_error_num_time_steps</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the simulate method raises an error when a float is given as input for num_time_steps argument.</span>

<span class="sd">    GIVEN: An invalid input type for num_time_steps in simulate method</span>

<span class="sd">    WHEN: I call simulate method</span>

<span class="sd">    THEN: A TypeError is raised</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span>
                       <span class="n">match</span> <span class="o">=</span> <span class="s1">&#39;Number of time steps must be an integer&#39;</span><span class="p">,</span>
                <span class="p">):</span> 
                    <span class="n">flock</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">num_time_steps</span> <span class="o">=</span> <span class="mf">100.5</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_simulate_value_error_num_time_steps">
<a class="viewcode-back" href="../test.html#test.test_simulate_value_error_num_time_steps">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_simulate_value_error_num_time_steps</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the simulate method raises an error when a negative value is given as input for num_time_steps argument.</span>

<span class="sd">    GIVEN: A negative value for num_time_steps in simulate method</span>

<span class="sd">    WHEN: I call simulate method</span>

<span class="sd">    THEN: A ValueError is raised</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    

    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span>
                       <span class="n">match</span> <span class="o">=</span> <span class="s1">&#39;Number of time steps must be &gt; 0&#39;</span><span class="p">,</span>
                <span class="p">):</span> 
                    <span class="n">flock</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">num_time_steps</span> <span class="o">=</span> <span class="o">-</span><span class="mi">100</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_simulate_correct_shape_first_array">
<a class="viewcode-back" href="../test.html#test.test_simulate_correct_shape_first_array">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_simulate_correct_shape_first_array</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the first array returned from simulate has the correct shape.</span>

<span class="sd">    GIVEN: A Flock object</span>

<span class="sd">    WHEN: I call simulate method</span>

<span class="sd">    THEN: The first returned array has shape (num_time_steps,N_birds, 2)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">birds_positions_per_time_steps</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">num_time_steps</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">birds_positions_per_time_steps</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_simulate_correct_shape_second_array">
<a class="viewcode-back" href="../test.html#test.test_simulate_correct_shape_second_array">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_simulate_correct_shape_second_array</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the second array returned from simulate has the correct shape.</span>

<span class="sd">    GIVEN: A Flock object</span>

<span class="sd">    WHEN: I call simulate method</span>

<span class="sd">    THEN: The second returned array has shape (num_time_steps,N_birds, 2)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">birds_velocities_per_time_steps</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">num_time_steps</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">birds_velocities_per_time_steps</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span></div>





<div class="viewcode-block" id="test_simulate_zero_velocity_and_forces">
<a class="viewcode-back" href="../test.html#test.test_simulate_zero_velocity_and_forces">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_simulate_zero_velocity_and_forces</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that given initial static birds without forces, the final positions are equal to the initial positions.</span>

<span class="sd">    GIVEN: A Flock object with static birds</span>

<span class="sd">    WHEN: I call simulate method with force parameters set to 0, i.e. total force equal 0</span>

<span class="sd">    THEN: The initial and final positions are equal</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">zero_velocities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">50</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">flock</span><span class="o">.</span><span class="n">init_given_velocities</span><span class="p">(</span><span class="n">zero_velocities</span><span class="p">)</span>

    <span class="n">initial_positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">flock</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span>

    <span class="n">_</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">separation</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> 
                        <span class="n">alignment</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> 
                        <span class="n">coherence</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="n">avoidance</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="n">num_time_steps</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span>

    <span class="n">final_positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">flock</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">initial_positions</span><span class="p">,</span> <span class="n">final_positions</span><span class="p">)</span></div>




<div class="viewcode-block" id="test_simulate_typical_usage_first_array">
<a class="viewcode-back" href="../test.html#test.test_simulate_typical_usage_first_array">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_simulate_typical_usage_first_array</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the first array returned from simulate is equal to the expected one given typical values of parameters.</span>

<span class="sd">    GIVEN: A Flock object </span>

<span class="sd">    WHEN: I call simulate method </span>

<span class="sd">    THEN: The first array is equal to the expected one</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>


    <span class="n">birds_positions_per_time_step</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">separation</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> 
                                                    <span class="n">alignment</span> <span class="o">=</span> <span class="mf">2.2</span><span class="p">,</span> 
                                                    <span class="n">coherence</span> <span class="o">=</span> <span class="mf">2.2</span><span class="p">,</span>
                                                    <span class="n">avoidance</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
                                                    <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
                                                    <span class="n">num_time_steps</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span>
                                                    <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
                                                    <span class="n">avoid_range</span> <span class="o">=</span> <span class="mi">40</span><span class="p">)</span>


    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">correct_positions_per_time_step</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">40</span><span class="p">)):</span>
        <span class="n">correct_positions_per_time_step</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">positions</span>

        <span class="n">flock</span><span class="o">.</span><span class="n">_update_state</span><span class="p">(</span><span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
                            <span class="n">separation</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> 
                            <span class="n">alignment</span> <span class="o">=</span> <span class="mf">2.2</span><span class="p">,</span> 
                            <span class="n">coherence</span> <span class="o">=</span> <span class="mf">2.2</span><span class="p">,</span>
                            <span class="n">avoidance</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
                            <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> 
                            <span class="n">avoid_range</span> <span class="o">=</span> <span class="mi">40</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">birds_positions_per_time_step</span><span class="p">,</span> <span class="n">correct_positions_per_time_step</span><span class="p">)</span></div>





<div class="viewcode-block" id="test_simulate_typical_usage_second_array">
<a class="viewcode-back" href="../test.html#test.test_simulate_typical_usage_second_array">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">test_simulate_typical_usage_second_array</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the second array returned from simulate is equal to the expected one given typical values of parameters.</span>

<span class="sd">    GIVEN: A Flock object </span>

<span class="sd">    WHEN: I call simulate method </span>

<span class="sd">    THEN: The second array is equal to the expected one</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>


    <span class="n">_</span><span class="p">,</span> <span class="n">birds_velocities_per_time_step</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">separation</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> 
                                                    <span class="n">alignment</span> <span class="o">=</span> <span class="mf">2.2</span><span class="p">,</span> 
                                                    <span class="n">coherence</span> <span class="o">=</span> <span class="mf">2.2</span><span class="p">,</span>
                                                    <span class="n">avoidance</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
                                                    <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
                                                    <span class="n">num_time_steps</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span>
                                                    <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
                                                    <span class="n">avoid_range</span> <span class="o">=</span> <span class="mi">40</span><span class="p">)</span>


    <span class="n">flock</span> <span class="o">=</span> <span class="n">Flock</span><span class="p">(</span><span class="n">N_birds</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">space_length</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">random_seed</span><span class="p">)</span>
    <span class="n">correct_velocities_per_time_step</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">40</span><span class="p">)):</span>
        <span class="n">correct_velocities_per_time_step</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">flock</span><span class="o">.</span><span class="n">velocities</span>

        <span class="n">flock</span><span class="o">.</span><span class="n">_update_state</span><span class="p">(</span><span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
                            <span class="n">separation</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> 
                            <span class="n">alignment</span> <span class="o">=</span> <span class="mf">2.2</span><span class="p">,</span> 
                            <span class="n">coherence</span> <span class="o">=</span> <span class="mf">2.2</span><span class="p">,</span>
                            <span class="n">avoidance</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
                            <span class="n">visual_range</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> 
                            <span class="n">avoid_range</span> <span class="o">=</span> <span class="mi">40</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">birds_velocities_per_time_step</span><span class="p">,</span> <span class="n">correct_velocities_per_time_step</span><span class="p">)</span></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Mario Massimo.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>